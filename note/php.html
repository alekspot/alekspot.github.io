<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>Note</title>
	<style>

		h2 {display: inline-block;}
		h3 {
			text-transform: uppercase;
			font-family: Tahoma;
			letter-spacing: 2px;
			text-align: center;
		}
		pre {
			font-family: "Courier New", Courier, mono;
			font-size: 20px;
		}
		.green {
			color:green;
			font-weight: bold;
		}
		
	</style>
</head>
<script>
	window.addEventListener('load', function () {
		var btnShow = document.querySelectorAll('.btnShow');
		for(var i = 0; i < btnShow.length;i++) {
			
			btnShow[i].addEventListener("click", function (e) {
				e.preventDefault();
				var href = this.getAttribute('href');
				var block = document.querySelector(href);

					if (block.style.display == "block") {
					    block.style.display = "none";
					} else {
                        block.style.display = "block";
					}
			});
		}
	})
</script>
<body>
	<h1>PHP7</h1><hr>
	<a href="https://vk.com/doc44301783_468385465?hash=e12d4438868d9ccaae&dl=46328f3eb887c79303">PHP7</a><hr>
	<h2>Чтение и запись</h2><a class="btnShow" href="#part1">+/-</a>
<div id="part1">
	<h3>Создать объект файлового потока</h3>
	<pre><span class="green">$fs</span> = <b>fopen</b>('имя_файла.txt', 'r')
				'w'
				'a'   - режим дополнения
				'r+'
				'w+'
				'a+'
or die('Error text');

fclose(<span class="green">$fs</span>);
	</pre><hr>
	<h3>Чтение по строкам</h3>
	<pre>
while(!<b>feof</b>(<span class="green">$fs</span>)){ //пока не достигнут конц файла

	echo <b>fgets</b>(<span class="green">$fs</span>) . '<бр>'
}
	</pre><hr>

	<h3>Чтение по символам</h3>
	<pre>
while($char = <b>fgetc</b>(<span class="green">$fs</span>)){  //FALSE, когда достигнут конец файла

	echo $char . '<бр>';

}
	</pre><hr>

	<h3>Запись в файл</h3>
	<pre>
$text = 'текст для записи';
$num = <b>fwrite</b>(<span class="green">$fs</span>, $text); //стирает всё,записывает и возвращает колличество байт.

}
	</pre><hr>
	<h3>Добавление текста</h3>
	<pre><span class="green">$fs</span> = <b>fopen</b>('имя_файла.txt', 'a') or die('Error text');
$text = 'текст для записи';
$num = <b>fwrite</b>(<span class="green">$fs</span>, $text); //стирает всё,записывает и возвращает колличество байт.

}
	</pre><hr>

	<h3>Обработка ошибок при чтении</h3>
	<pre>set_error_handler('имя функции обработчика') //установить обработчик ошибки

trigger_error('текст ошибки') //вызвать явно ошибку
	</pre><hr>

	
</div><br>
	<h2>Работа с формами</h2><a class="btnShow" href="#part2">+/-</a>
<div id="part2">
	<h3>Метод POST, передача параметров, валидация</h3>
	<pre>
&lt;form action="file.php" <b>method="POST"</b>&gt;
  &lt;input type="text" name = "mail"&gt;    $_POST['mail']
  &lt;input type="text" name = "phone"&gt;   $_POST['phone']
&lt;/form&gt;
<span class="green">Пустые элементы формы передают NULL</span>

<b>isset</b>($_POST['mail']); - проверяет переменную на отличие от NULL

<b>empty</b>($_POST['mail']); - возвращает TRUE если переменная 0,'',Null,false

<b>is_numeric</b>($_POST['mail']) - TRUE если число

<b>preg_match</b>(регулярное выражение, $_POST['mail']) - проверка через рег.выражение

<b>filter_var</b>($_POST['mail'],FILTER_VALIDATE_EMAIL) - TRUE если проверка прошла.
                                          BOOLEAN
                                          FLOAT
                                          INT - можно указать диапазон
                                          IP
                                          MAC ...
	</pre>
<h3>Обработка данных формы одним файлом.php</h3>
<pre><span class="green">Вывод формы происходит методом GET, обработка методом POST.</span>

&lt;form <b>action="файл указывает сам на себя" method="POST"</b>&gt;
  &lt;input type="text" name = "mail"&gt;    $_POST['mail']
  &lt;input type="text" name = "phone"&gt;   $_POST['phone']
&lt;/form&gt;

<span class="green">Чтобы проверить каким методом обращается клиент используется:</span> $_SERVER['REQUEST_METHOD']

<b>Пример:</b>
&lt;?php

if($_SERVER['REQUEST_METHOD']!='POST') { //если обратились методом GET,т.е через URL

	//отобразить форму
}
else {

	//обработать форму
}
?&gt;
</pre>
<h3>Сохранение данных в форме</h3>
<pre>
<span class="green">Для того чтобы значения полей формы не сбрасывались присваиваем значение атрибуту тега &lt;input&gt;</span> 
value = "&lt;?php if(isset($_POST['name']) echo $_POST['name']"
</pre>
<h3>Разделение html файла на блоки</h3>
<pre>PHP функции <b>include</b>(url) и <b>require</b>(url) <span class="green"> позволяют подключать отдельно html-файлы(хедеры,футеры и.т.д.);</span> 
</pre>
</div>
</body>
</html>